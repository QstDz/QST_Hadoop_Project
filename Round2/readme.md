一、将这些日志存储在HDFS上，HDFS会保存三个副本，强一致性、安全可靠。将一些需要实时查询的数据存入HBase，通过web页面进行查询

二、统计实现

  1、统计每日、周、月的UV数量

    （1）程序运行时传入参数（which day、which week、which month），输入为日志存放目录，输出为按需统计出的UV数量

    （2）map的输出以ip做key，1为value。reduce输出key为日或周或月，value为UV数量

    （3）在reduce中设置全局计数器counter记录下来ip数量

  2、统计每日的PV量

    （1）输入为要统计的那天的数据，输出为该天的PV数量

    （2）map中设置计数器，统计访问记录的数量，输出为该计数器的值，即当天的PV数量。

  3、统计次日留存、次月留存

    （1）次日留存

        输入数据为该天及后一天的数据，输出为留存率，即连续访问过两天的ip数量占第一天ip数量的比例

        map的输出key为ip，value为根据访问时间做的标记。如第一天的标记为a，第二天的标记为b

        reduce中设置两个全局计数器，一个记录含有a的ip的数量，即为第一天的UV，另一个记录同时含有a和b标记的ip数量，即为留存ip数量

        在main函数中获取两个计数器的值，求比例

    （2）次月留存（原理与次日留存相同）

        输入数据为该月及后一月的数据，输出为留存率，即连续访问过两天的ip数量占第一天ip数量的比例

        map的输出key为ip，value为根据访问时间做的标记。如第一月的标记为a，第二月的标记为b

        reduce中设置两个全局计数器，一个记录含有a的ip的数量，即为第一天的UV，另一个记录同时含有a和b标记的ip数量，即为留存ip数量

        在main函数中获取两个计数器的值，求比例

  4、统计每类网页的跳转率

    （1）首先根据数据确定有哪几类网页

    （2）输入为需要统计跳转率的数据，输出为希望统计的某类网页的跳转率

    （3）map输出key为该网页url，value为跳转网页url

    （4）reduce中设置两个全局计数器，其中一个记录该网页的数量，另一个为跳转网页的数量

    （5）main函数中获取计数器数值，进行比例求值

  5、统计每天从baidu跳转过来的PV

    （1）输入为一天的数据，输出为从百度跳转过来的PV

    （2）map输出key为网页url，value为跳转url

    （3）reduce设置计数器统计跳转url为baidu的数量

    （4）main函数中输出计数器数值

  6、统计每天从ios和Android的UV数

    （1）输入为一天的数据，输出为从ios和Android跳转过来的用户数量

    （2）map输出key为ip，value为该用户的设备

    （3）reduce设置计数器，若该用户设备为ios或Android，则计数器加一

    （4）main函数中输出计数器的数值，即为ios和Android的UV

  7、实时查询show的访问数量和musician的访问数量

    （1）利用streaming的形式对数据进行清洗，将show和musician的访问记录存放到HBase中

    （2）设计web页面，链接HBase，进行实时查询show和musician的访问数量

三、项目拆解

    预计周日之前完成统计需求的代码编写与调试，周三之前完成实时查询需求
